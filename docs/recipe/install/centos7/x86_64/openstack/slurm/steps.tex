\documentclass[letterpaper]{article}
\usepackage{./common/ohpc-doc}
\setcounter{secnumdepth}{5}
\setcounter{tocdepth}{5}

% Include git variables
\input{vc.tex}

% Define Base OS and other local macros
\newcommand{\baseOS}{CentOS7.3}
\newcommand{\OSRepo}{CentOS\_7.3}
\newcommand{\OSTree}{CentOS\_7}
\newcommand{\OSTag}{el7}
\newcommand{\baseos}{centos7.3}
\newcommand{\provisioner}{Openstack}
\newcommand{\rms}{SLURM}
\newcommand{\arch}{x86\_64}
\newcommand{\clean}{yum clean expire-cache}
\newcommand{\chrootclean}{yum --installroot=\$CHROOT clean expire-cache}
\newcommand{\install}{yum -y install}
\newcommand{\chrootinstall}{yum -y --installroot=\$CHROOT install}
\newcommand{\groupinstall}{yum -y groupinstall}
\newcommand{\groupchrootinstall}{yum -y --installroot=\$CHROOT groupinstall}
\newcommand{\upgrade}{yum -y upgrade}
\newcommand{\chrootupgrade}{yum -y --installroot=\$CHROOT upgrade}



% boolean for os-specific formatting
\toggletrue{isCentOS}
\toggletrue{isCentOS_ww_slurm_x86}
\toggletrue{isx86}

\begin{document}
\graphicspath{{common/figures/}}
\thispagestyle{empty}

% Title Page
\input{common/title}
% Disclaimer 
\input{common/legal} 

\newpage
\tableofcontents
\newpage

% Introduction  --------------------------------------------------

\section{Introduction} \label{sec:introduction}
\input{common/install_header}
\input{common/intro} 

\input{common/base_edition/edition}
\input{common/audience}
\input{common/requirements}
\input{common/inputs}

% Bare Metal Node Operating System --------------------------------------------
\clearpage
% ohpc_validation_comment #   XFILEX chpc_prepare_image
\section{Preparing Bare Metal Node Operating System}\label{sec:baremetalprep}
\input{common/bmnos}

\subsection{Install and Setup diskimage-builder}\label{sec:dib_install}
\input{common/bmnos-dibinstall}

\subsection{Setup common environment for diskimage-builder}\label{sec:dib_environment}
\input{common/bmnos-dibenv}

\subsection{Preparing ironic deploy images}\label{sec:ironic_deploy_images}
\input{common/bmnos-ironicdeploy}

\subsection{Preparing user images for bare metal instances}\label{sec:bare_metal_user_images}
\input{common/bmnos-userimages}

\subsubsection{Preparing user image for head node OS}\label{sec:head_node_images}
\input{common/bmnos-headnodeimage}

\subsubsection{Preparing user image for compute node OS}\label{sec:compute_node_images}
\input{common/bmnos-computenodeimage}

\subsubsection{Putting all together }\label{sec:compute_node_images_all_together}
\input{common/bmnos-all-together}

%%\subsection{Introduction to diskimage-builder}\label{sec:din_intro}
%%\input{common/bmnos-dibintro}

% ------------------------------------------------------------------
\clearpage

\section{Preparing Cloud-Init} \label{sec:cloud-init_prep}
\input{common/cloud-init-prep.tex}


\subsection{Preparing template for compute node cloud-init} \label{sec:c_i-template_compute_node}
\input{common/ci-template-compute}


\subsection{Preparing template for sms node cloud-init} \label{sec:c_i-template-sms-node}
\input{common/c_i-template-sms}
	

\subsection{Prepare optional part of cloud-init} \label{sec:c_i-optional}

\input{common/c_i-optional}

\subsection{Configuring overall cloud-init} \label{sec:c_i-config}

\input{common/c_i-config}




\vspace*{-0.15cm}
\vspace*{-0.50cm}

\clearpage
\section{Instantiating OpenHPC System in OpenStack Cloud}
\input{common/instantiate.tex}
	
\clearpage
\subsection{Prepare OpenStack for bare metal provisioning with ironic} \label{sec:o-s_prep-ironic}
\input{common/o-s_prep-ironic}

\vspace*{-0.15cm}
\subsection{Instantiate bare metal nodes} \label{sec:instantiate-bare-metal}
\input{common/inst-bare-metal}

\section{Appendix}
\input{common/appendix_a}

\end{document}
