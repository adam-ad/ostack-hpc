

   This guide uses the diskimage-builder utility to build and configure OS images for both the sms node, and compute nodes.  Preparing images is an optional part of the overall recipe. If user has predefined images, then environment variable "chpc\_create\_new\_image" must be reset and path to images must be provided using environment variables "chpc\_image\_deploy\_kernel", "chpc\_image\_deploy\_ramdisk", "chpc\_image\_user", and "chpc\_image\_sms". 

	In this example cloud images are built on controller node ("[ctrlr]\# "). Once images are built, they are stored in the standard OpenHPC Path. 
	
	The recipes generated from this document create utility functions for each functionality and then integrate them to make a complete recipe to create a compute node OS image. 
	
	First, setup a path for images to be stored.

% begin_ohpc_run
% ohpc_validation_newline
% ohpc_validation_comment #   XFILEX
% ohpc_command #!/bin/bash
% ohpc_validation_comment # File: prepare_chpc_image
%% ohpc_validation_comment # SECTION BMNOS 
% ohpc_validation_comment Set cloud image path 
% ohpc_validation_comment 

\begin{lstlisting}[language=bash,keywords={},upquote=true]
[ctrlr](*\#*) CHPC_CLOUD_IMAGE_PATH=/opt/ohpc/admin/images/cloud/
\end{lstlisting}
% end_ohpc_run
